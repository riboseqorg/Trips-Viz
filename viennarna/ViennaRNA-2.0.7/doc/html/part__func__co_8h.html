<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RNAlib-2.0.7: H/part_func_co.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RNAlib-2.0.7</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('part__func__co_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">H/part_func_co.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Partition function for two RNA sequences.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
Include dependency graph for part_func_co.h:</div>
<div class="dyncontent">
<div class="center"><img src="part__func__co_8h__incl.png" border="0" usemap="#H_2part__func__co_8h" alt=""/></div>
<map name="H_2part__func__co_8h" id="H_2part__func__co_8h">
<area shape="rect" id="node3" href="data__structures_8h.html" title="All datastructures and typedefs shared among the Vienna RNA Package can be found here." alt="" coords="5,83,139,112"/><area shape="rect" id="node5" href="energy__const_8h.html" title="energy constants" alt="" coords="12,160,132,189"/></map>
</div>
</div>
<p><a href="part__func__co_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcofoldF.html">cofoldF</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#aa86a5f998789ed71813d23d7307a791b">co_pf_fold</a> (char *sequence, char *structure)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate partition function and base pair probabilities.  <a href="#aa86a5f998789ed71813d23d7307a791b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcofoldF.html">cofoldF</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#abd873b450832ab5f21101fc5ab354d21">co_pf_fold_par</a> (char *sequence, char *structure, <a class="el" href="structpf__paramT.html">pf_paramT</a> *parameters, int calculate_bppm, int is_constrained)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate partition function and base pair probabilities.  <a href="#abd873b450832ab5f21101fc5ab354d21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">FLT_OR_DBL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#ad94c0133157bed6912fe7fe866e0039e">export_co_bppm</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the base pair probability array.  <a href="#ad94c0133157bed6912fe7fe866e0039e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ade3ce34ae8214811374b1d28a40dc247"></a><!-- doxytag: member="part_func_co.h::free_co_pf_arrays" ref="ade3ce34ae8214811374b1d28a40dc247" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#ade3ce34ae8214811374b1d28a40dc247">free_co_pf_arrays</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free the memory occupied by <a class="el" href="part__func__co_8h.html#aa86a5f998789ed71813d23d7307a791b" title="Calculate partition function and base pair probabilities.">co_pf_fold()</a> <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#a6e0f36c1f9b7d9dd4bfbad914c1119e5">update_co_pf_params</a> (int length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Recalculate energy parameters.  <a href="#a6e0f36c1f9b7d9dd4bfbad914c1119e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#a117d880df45bef444d5e2785ffa40a53">update_co_pf_params_par</a> (int length, <a class="el" href="structpf__paramT.html">pf_paramT</a> *parameters)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Recalculate energy parameters.  <a href="#a117d880df45bef444d5e2785ffa40a53"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#a15ae04ac5ab84e876dcf0093120cb617">compute_probabilities</a> (double FAB, double FEA, double FEB, struct <a class="el" href="structplist.html">plist</a> *prAB, struct <a class="el" href="structplist.html">plist</a> *prA, struct <a class="el" href="structplist.html">plist</a> *prB, int Alength)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Boltzmann probabilities of dimerization without homodimers.  <a href="#a15ae04ac5ab84e876dcf0093120cb617"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConcEnt.html">ConcEnt</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#a5545cb936ac4ff93c7d699d46e72e8c7">get_concentrations</a> (double FEAB, double FEAA, double FEBB, double FEA, double FEB, double *startconc)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers.  <a href="#a5545cb936ac4ff93c7d699d46e72e8c7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structplist.html">plist</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#a334de3c96e2186abfbdc0eaea6d08b14">get_plist</a> (struct <a class="el" href="structplist.html">plist</a> *pl, int length, double cut_off)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DO NOT USE THIS FUNCTION ANYMORE.  <a href="#a334de3c96e2186abfbdc0eaea6d08b14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#aa12dda9dd6179cdd22bcce87c0682c07">init_co_pf_fold</a> (int length)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DO NOT USE THIS FUNCTION ANYMORE.  <a href="#aa12dda9dd6179cdd22bcce87c0682c07"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aff27888c4088cc1f60fd59cbd589474c"></a><!-- doxytag: member="part_func_co.h::mirnatog" ref="aff27888c4088cc1f60fd59cbd589474c" args="" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#aff27888c4088cc1f60fd59cbd589474c">mirnatog</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggles no intrabp in 2nd mol. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2d1851a710a8561390861155ca988fe"></a><!-- doxytag: member="part_func_co.h::F_monomer" ref="ac2d1851a710a8561390861155ca988fe" args="[2]" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="part__func__co_8h.html#ac2d1851a710a8561390861155ca988fe">F_monomer</a> [2]</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Free energies of the two monomers. <br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Partition function for two RNA sequences. </p>
<p>As for folding one RNA molecule, this computes the partition function of all possible structures and the base pair probabilities. Uses the same global <a class="el" href="fold__vars_8h.html#ad3b22044065acc6dee0af68931b52cfd" title="A scaling factor used by pf_fold() to avoid overflows.">pf_scale</a> variable to avoid overflows.</p>
<p>To simplify the implementation the partition function computation is done internally in a null model that does not include the duplex initiation energy, i.e. the entropic penalty for producing a dimer from two monomers). The resulting free energies and pair probabilities are initially relative to that null model. In a second step the free energies can be corrected to include the dimerization penalty, and the pair probabilities can be divided into the conditional pair probabilities given that a re dimer is formed or not formed.</p>
<p>After computing the partition functions of all possible dimeres one can compute the probabilities of base pairs, the concentrations out of start concentrations and sofar and soaway.</p>
<p>Dimer formation is inherently concentration dependent. Given the free energies of the monomers A and B and dimers AB, AA, and BB one can compute the equilibrium concentrations, given input concentrations of A and B, see e.g. Dimitrov &amp; Zuker (2004) </p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa86a5f998789ed71813d23d7307a791b"></a><!-- doxytag: member="part_func_co.h::co_pf_fold" ref="aa86a5f998789ed71813d23d7307a791b" args="(char *sequence, char *structure)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcofoldF.html">cofoldF</a> co_pf_fold </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>structure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate partition function and base pair probabilities. </p>
<p>This is the cofold partition function folding. The second molecule starts at the <a class="el" href="fold__vars_8h.html#ab9b2c3a37a5516614c06d0ab54b97cda" title="Marks the position (starting from 1) of the first nucleotide of the second molecule within the concat...">cut_point</a> nucleotide.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>OpenMP: Since this function relies on the global parameters <a class="el" href="fold__vars_8h.html#ad512b5dd4dbec60faccfe137bb474489" title="do backtracking, i.e.">do_backtrack</a>, <a class="el" href="fold__vars_8h.html#a72b511ed1201f7e23ec437e468790d74" title="Switch the energy model for dangling end contributions (0, 1, 2, 3)">dangles</a>, <a class="el" href="fold__vars_8h.html#ab4b11c8d9c758430960896bc3fe82ead" title="Rescale energy parameters to a temperature in degC.">temperature</a> and <a class="el" href="fold__vars_8h.html#ad3b22044065acc6dee0af68931b52cfd" title="A scaling factor used by pf_fold() to avoid overflows.">pf_scale</a> it is not threadsafe according to concurrent changes in these variables! Use <a class="el" href="part__func__co_8h.html#abd873b450832ab5f21101fc5ab354d21" title="Calculate partition function and base pair probabilities.">co_pf_fold_par()</a> instead to circumvent this issue.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="part__func__co_8h.html#abd873b450832ab5f21101fc5ab354d21" title="Calculate partition function and base pair probabilities.">co_pf_fold_par()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence</td><td>Concatenated RNA sequences </td></tr>
    <tr><td class="paramname">structure</td><td>Will hold the structure or constraints </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structcofoldF.html">cofoldF</a> structure containing a set of energies needed for concentration computations. </dd></dl>

</div>
</div>
<a class="anchor" id="abd873b450832ab5f21101fc5ab354d21"></a><!-- doxytag: member="part_func_co.h::co_pf_fold_par" ref="abd873b450832ab5f21101fc5ab354d21" args="(char *sequence, char *structure, pf_paramT *parameters, int calculate_bppm, int is_constrained)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcofoldF.html">cofoldF</a> co_pf_fold_par </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpf__paramT.html">pf_paramT</a> *&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calculate_bppm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_constrained</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate partition function and base pair probabilities. </p>
<p>This is the cofold partition function folding. The second molecule starts at the <a class="el" href="fold__vars_8h.html#ab9b2c3a37a5516614c06d0ab54b97cda" title="Marks the position (starting from 1) of the first nucleotide of the second molecule within the concat...">cut_point</a> nucleotide.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="params_8h.html#a6fc2f3eef5a3024d44963ac59a42e39d" title="Get precomputed Boltzmann factors of the loop type dependent energy contributions with independent th...">get_boltzmann_factors()</a>, <a class="el" href="part__func__co_8h.html#aa86a5f998789ed71813d23d7307a791b" title="Calculate partition function and base pair probabilities.">co_pf_fold()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence</td><td>Concatenated RNA sequences </td></tr>
    <tr><td class="paramname">structure</td><td>Pointer to the structure constraint </td></tr>
    <tr><td class="paramname">parameters</td><td>Data structure containing the precalculated Boltzmann factors </td></tr>
    <tr><td class="paramname">calculate_bppm</td><td>Switch to turn Base pair probability calculations on/off (0==off) </td></tr>
    <tr><td class="paramname">is_constrained</td><td>Switch to indicate that a structure contraint is passed via the structure argument (0==off) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structcofoldF.html">cofoldF</a> structure containing a set of energies needed for concentration computations. </dd></dl>

</div>
</div>
<a class="anchor" id="ad94c0133157bed6912fe7fe866e0039e"></a><!-- doxytag: member="part_func_co.h::export_co_bppm" ref="ad94c0133157bed6912fe7fe866e0039e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FLT_OR_DBL* export_co_bppm </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a pointer to the base pair probability array. </p>
<p>Accessing the base pair probabilities for a pair (i,j) is achieved by </p>
<div class="fragment"><pre class="fragment">FLT_OR_DBL *pr = export_bppm(); pr_ij = pr[iindx[i]-j]; </pre></div><dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="utils_8h.html#a55c0f6b3b07b6adf2ee235ba901fe397" title="Get an index mapper array (iindx) for accessing the energy matrices, e.g.">get_iindx()</a> </dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to the base pair probability array </dd></dl>

</div>
</div>
<a class="anchor" id="a6e0f36c1f9b7d9dd4bfbad914c1119e5"></a><!-- doxytag: member="part_func_co.h::update_co_pf_params" ref="a6e0f36c1f9b7d9dd4bfbad914c1119e5" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_co_pf_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Recalculate energy parameters. </p>
<p>This function recalculates all energy parameters given the current model settings.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This function relies on the global variables <a class="el" href="fold__vars_8h.html#ad3b22044065acc6dee0af68931b52cfd" title="A scaling factor used by pf_fold() to avoid overflows.">pf_scale</a>, <a class="el" href="fold__vars_8h.html#a72b511ed1201f7e23ec437e468790d74" title="Switch the energy model for dangling end contributions (0, 1, 2, 3)">dangles</a> and <a class="el" href="fold__vars_8h.html#ab4b11c8d9c758430960896bc3fe82ead" title="Rescale energy parameters to a temperature in degC.">temperature</a>. Thus it might not be threadsafe in certain situations. Use <a class="el" href="part__func__co_8h.html#a117d880df45bef444d5e2785ffa40a53" title="Recalculate energy parameters.">update_co_pf_params_par()</a> instead.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="params_8h.html#a6fc2f3eef5a3024d44963ac59a42e39d" title="Get precomputed Boltzmann factors of the loop type dependent energy contributions with independent th...">get_boltzmann_factors()</a>, <a class="el" href="part__func__co_8h.html#a117d880df45bef444d5e2785ffa40a53" title="Recalculate energy parameters.">update_co_pf_params_par()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>Length of the current RNA sequence </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a117d880df45bef444d5e2785ffa40a53"></a><!-- doxytag: member="part_func_co.h::update_co_pf_params_par" ref="a117d880df45bef444d5e2785ffa40a53" args="(int length, pf_paramT *parameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_co_pf_params_par </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpf__paramT.html">pf_paramT</a> *&#160;</td>
          <td class="paramname"><em>parameters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Recalculate energy parameters. </p>
<p>This function recalculates all energy parameters given the current model settings. It's second argument can either be NULL or a data structure containing the precomputed Boltzmann factors. In the first scenario, the necessary data structure will be created automatically according to the current global model settings, i.e. this mode might not be threadsafe. However, if the provided data structure is not NULL, threadsafety for the model parameters <a class="el" href="fold__vars_8h.html#a72b511ed1201f7e23ec437e468790d74" title="Switch the energy model for dangling end contributions (0, 1, 2, 3)">dangles</a>, <a class="el" href="fold__vars_8h.html#ad3b22044065acc6dee0af68931b52cfd" title="A scaling factor used by pf_fold() to avoid overflows.">pf_scale</a> and <a class="el" href="fold__vars_8h.html#ab4b11c8d9c758430960896bc3fe82ead" title="Rescale energy parameters to a temperature in degC.">temperature</a> is regained, since their values are taken from this data structure during subsequent calculations.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="params_8h.html#a6fc2f3eef5a3024d44963ac59a42e39d" title="Get precomputed Boltzmann factors of the loop type dependent energy contributions with independent th...">get_boltzmann_factors()</a>, <a class="el" href="part__func__co_8h.html#a6e0f36c1f9b7d9dd4bfbad914c1119e5" title="Recalculate energy parameters.">update_co_pf_params()</a></dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>Length of the current RNA sequence </td></tr>
    <tr><td class="paramname">parameters</td><td>data structure containing the precomputed Boltzmann factors </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a15ae04ac5ab84e876dcf0093120cb617"></a><!-- doxytag: member="part_func_co.h::compute_probabilities" ref="a15ae04ac5ab84e876dcf0093120cb617" args="(double FAB, double FEA, double FEB, struct plist *prAB, struct plist *prA, struct plist *prB, int Alength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_probabilities </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FAB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structplist.html">plist</a> *&#160;</td>
          <td class="paramname"><em>prAB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structplist.html">plist</a> *&#160;</td>
          <td class="paramname"><em>prA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structplist.html">plist</a> *&#160;</td>
          <td class="paramname"><em>prB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Alength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute Boltzmann probabilities of dimerization without homodimers. </p>
<p>Given the pair probabilities and free energies (in the null model) for a dimer AB and the two constituent monomers A and B, compute the conditional pair probabilities given that a dimer AB actually forms. Null model pair probabilities are given as a list as produced by <a class="el" href="part__func_8h.html#a2f29542659beb5ebd176631a3da11580" title="Create a plist from a probability matrix.">assign_plist_from_pr()</a>, the dimer probabilities 'prAB' are modified in place.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">FAB</td><td>free energy of dimer AB </td></tr>
    <tr><td class="paramname">FEA</td><td>free energy of monomer A </td></tr>
    <tr><td class="paramname">FEB</td><td>free energy of monomer B </td></tr>
    <tr><td class="paramname">prAB</td><td>pair probabilities for dimer </td></tr>
    <tr><td class="paramname">prA</td><td>pair probabilities monomer </td></tr>
    <tr><td class="paramname">prB</td><td>pair probabilities monomer </td></tr>
    <tr><td class="paramname">Alength</td><td>Length of molecule A </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5545cb936ac4ff93c7d699d46e72e8c7"></a><!-- doxytag: member="part_func_co.h::get_concentrations" ref="a5545cb936ac4ff93c7d699d46e72e8c7" args="(double FEAB, double FEAA, double FEBB, double FEA, double FEB, double *startconc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConcEnt.html">ConcEnt</a>* get_concentrations </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEAB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEAA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEBB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FEB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>startconc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers. </p>
<p>This function takes an array 'startconc' of input concentrations with alternating entries for the initial concentrations of molecules A and B (terminated by two zeroes), then computes the resulting equilibrium concentrations from the free energies for the dimers. Dimer free energies should be the dimer-only free energies, i.e. the FcAB entries from the <a class="el" href="structcofoldF.html">cofoldF</a> struct.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">FEAB</td><td>Free energy of AB dimer (FcAB entry) </td></tr>
    <tr><td class="paramname">FEAA</td><td>Free energy of AA dimer (FcAB entry) </td></tr>
    <tr><td class="paramname">FEBB</td><td>Free energy of BB dimer (FcAB entry) </td></tr>
    <tr><td class="paramname">FEA</td><td>Free energy of monomer A </td></tr>
    <tr><td class="paramname">FEB</td><td>Free energy of monomer B </td></tr>
    <tr><td class="paramname">startconc</td><td>List of start concentrations [a0],[b0],[a1],[b1],...,[an][bn],[0],[0] </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structConcEnt.html">ConcEnt</a> array containing the equilibrium energies and start concentrations </dd></dl>

</div>
</div>
<a class="anchor" id="a334de3c96e2186abfbdc0eaea6d08b14"></a><!-- doxytag: member="part_func_co.h::get_plist" ref="a334de3c96e2186abfbdc0eaea6d08b14" args="(struct plist *pl, int length, double cut_off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structplist.html">plist</a>* get_plist </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structplist.html">plist</a> *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cut_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DO NOT USE THIS FUNCTION ANYMORE. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000016">Deprecated:</a></b></dt><dd>{ This function is deprecated and will be removed soon!} use <a class="el" href="part__func_8h.html#a2f29542659beb5ebd176631a3da11580">assign_plist_from_pr()</a> instead! </dd></dl>

</div>
</div>
<a class="anchor" id="aa12dda9dd6179cdd22bcce87c0682c07"></a><!-- doxytag: member="part_func_co.h::init_co_pf_fold" ref="aa12dda9dd6179cdd22bcce87c0682c07" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_co_pf_fold </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DO NOT USE THIS FUNCTION ANYMORE. </p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000017">Deprecated:</a></b></dt><dd>{ This function is deprecated and will be removed soon!} </dd></dl>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="part__func__co_8h.html">part_func_co.h</a>      </li>
      <li class="footer">Generated on Fri May 18 2012 for RNAlib-2.0.7 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>

</body>
</html>
